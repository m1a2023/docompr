
syntax = "proto3";

package compr;


message FileMeta {
    string title = 1;
    string path = 2;
    string hash = 3;
}

message FileChunk {
    optional int32 offset = 1;
    optional bytes data = 2;
}

message SmallFileRequest {
    required string uuid;
    FileMeta meta = 1;
    FileChunk chunk = 2;
}

message FileRequest {
    required string uuid;
    oneof payload {
        FileMeta meta = 1;
        FileChunk chunk = 2;
    }
}

message FileResponse {
    int32 code = 1;
    string message = 2;
}

service Compressor {
    rpc CompressSmallFile(SmallFileRequest) returns (FileResponse) {}
    rpc CompressLargeFile(stream FileRequest) returns (FileResponse) {}
}